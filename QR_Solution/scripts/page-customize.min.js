function customizeQR(){var n=this;this.getColorValue=function(){bgColor=$("#bgColorInput input").val();dataColor=$("#dataColorInput input").val();eye_l_in=$("#eye1In input").val();eye_l_out=$("#eye1Out input").val();eye_r_in=$("#eye2In input").val();eye_r_out=$("#eye2Out input").val();eye_b_in=$("#eye3In input").val();eye_b_out=$("#eye3Out input").val()};this.loadQRByID=function(n){$.ajax({url:"http://mirascan.vn:32000/api/qrcode-api/get?id="+n,type:"GET",success:function(n){if(n.status=="success")imageSize=n.data.size,common.generateQRCodeData(n.data.size-8,n.data.path_base);else{console.log("load errr");return}},error:function(){console.log("something error")}})};this.editBackground=function(){$("#bgColorInput").colorpicker({color:"#ffffff"}).on("changeColor",function(t){n.getColorValue();bgColor=t.value;$("#bgColor").css("background",bgColor);bgColor!==null&&bgColor!==""&&bgColor!==undefined&&common.checkQRContrast(bgColor,dataColor,eye_l_in,eye_l_out,eye_r_in,eye_r_out,eye_b_in,eye_b_out)})};this.editDataPartenr=function(){$("#dataColorInput").colorpicker({color:"#000000"}).on("changeColor",function(t){$("#qr-mira >.data-pattern").children().css("fill",t.value);n.getColorValue();dataColor=t.value;dataColor!==null&&dataColor!==""&&dataColor!==undefined&&common.checkQRContrast(bgColor,dataColor,eye_l_in,eye_l_out,eye_r_in,eye_r_out,eye_b_in,eye_b_out)});$(".data-partern-shape").on("click",function(){var t="",i="./images/newcreate/svg/patterns/",o=$(this).attr("data-name"),r=$("#dataColorInput input").val(),u=".svg",f=$(this).attr("data-type"),e,n;f!==null&&f!==undefined&&f!==""?(e=o.split(","),n=0,$("#orgigin").html('<object type="image/svg+xml" data="'+t+i+e[0]+u+'" width="100%" height="100%" id="dataShapeObj1"><\/object><object type="image/svg+xml" data="'+t+i+e[1]+u+'" width="100%" height="100%" id="dataShapeObj2"><\/object>'),$("#orgigin #dataShapeObj1").load(function(){n++;var t=common.getObjectChild("#dataShapeObj1").html();$("#qr-mira >.data-pattern g:nth-child(2n+1)").html(t);n==2&&($("#qr-mira >.data-pattern").children().css("fill",r),$("#orgigin object").remove())}),$("#orgigin #dataShapeObj2").load(function(){n++;var t=common.getObjectChild("#dataShapeObj2").html();$("#qr-mira >.data-pattern g:nth-child(2n)").html(t);n==2&&($("#qr-mira >.data-pattern").children().css("fill",r),$("#orgigin").html(""))})):($("#orgigin").html('<object type="image/svg+xml" data="'+t+i+o+u+'" width="100%" height="100%" id="dataShapeObj"><\/object>'),$("#orgigin #dataShapeObj").load(function(){common.loadDataShape("#dataShapeObj");$("#qr-mira >.data-pattern").children().css("fill",r);$("#orgigin").html("")}))})};this.editEye=function(){$(".eye-picker").colorpicker({color:"#000001",format:"hex"}).on("changeColor",function(t){var y=$(t.currentTarget).find("input").attr("data-eye"),i=t.value,o=!0,r,l,a,v;$(t.currentTarget).find("input").attr("data-eye-fill")!=="ex"&&(o=!1);r=$(".right-pannel").find(".box-"+y);o?r.children(":nth-child(1)").css("fill",i):r.children(":nth-child(2)").css("fill",i);n.getColorValue();var u=!1,f=!1,s=!1;if(i!=null&&i!=""&&i!=undefined&&bgColor!=null&&bgColor!=""&&bgColor!=undefined){var h="#ffffff",c="#ffff00",e=15;$(".eye-picke").not(t.currentTarget).find("input").each(function(){var t=common.SimilarColor($(this).val(),h),i=common.SimilarColor($(this).val(),c),n;return t>.95||i>.95?(u=!0,!1):(n=common.checkContrast($(this).val(),bgColor),n<e)?(u=!0,!1):void 0});l=common.SimilarColor(i,h);a=common.SimilarColor(i,c);l>.95||a>.95?f=!0:(v=common.checkContrast(i,bgColor),v<e&&(f=!0));dataContrast=common.checkContrast(dataColor,bgColor);dataContrast<e&&(s=!0);u||f||s?($("#errorQR").show(),$("#bgColor").addClass("errQR")):($("#errorQR").hide(),$("#bgColor").removeClass("errQR"))}});$(".eye-shape").on("click",function(){$("#orgigin").html('<object type="image/svg+xml" data="'+$(this).find("img").attr("src")+'" width="100%" height="100%" id="svgShape"><\/object>');$("#orgigin object").load(function(){$(".svg-eye").html("");common.loadEyeShape("#svgShape");common.fillEyeColor(".box-1",$("#eye1In").val(),$("#eye1Out").val());common.fillEyeColor(".box-2",$("#eye2In").val(),$("#eye2Out").val());common.fillEyeColor(".box-3",$("#eye3In").val(),$("#eye3Out").val());$("#orgigin object").remove()})})};this.editFrame=function(){common.FillterByCategory(1);$("#frameCat").on("change",function(){common.FillterByCategory($(this).val())});$(".masonry-layout .item > a").on("click",function(){var n=$(this).find("img").attr("src").split("fr_")[0]+$(this).find("img").attr("alt");$(".qr-iframe").html('<img class="img-frame" src="'+n+'">');$(".right-pannel").addClass("qr-frame-bg");$("body").addClass("bg-frame");$(".qr-iframe .img-frame").on("load",function(){var n=$(".qr-iframe .img-frame").height()+30;$(".qr-image").height(n)})});$("#fr-edit").on("click",function(){$(".tab-menu").addClass("disabled-block");$("#outline-check").prop("checked")?$("#bgColor").addClass("outline"):$("#bgColor").removeClass("outline");$(".btn-action").hide();$("#fr-cancel").fadeIn();$("#fr-edit").hide();$("#fr-save").removeClass("disabled");$(".fr-option").removeClass("disabled-frame");$("#opacity-val").val(opacityValue);$("#bgColor").addClass("fr-box");$("#bgColor").draggable({containment:".qr-image",scroll:!1,cursor:"move",cancel:".ui-rotatable-handle"});var n=0;$("#bgColor").attr("style")!=undefined&&(n=$("#bgColor").attr("style").split("rotate(")[1],n=n!=undefined?n.split("rad")[0]:"0");$("#bgColor").resizable({aspectRatio:!0}).rotatable({wheelRotate:!1,radians:parseFloat(n)})});$("#fr-cancel").on("click",function(){$(".tab-menu").removeClass("disabled-block");$("#bgColor").removeClass("outline");$("#bgColor").resizable("destroy");$("#bgColor").draggable("destroy");$("#bgColor").rotatable("destroy");$(".btn-action").show();$("#fr-edit").fadeIn();$("#fr-cancel").hide();$("#fr-save").addClass("disabled");$(".fr-option").addClass("disabled-frame");var n=$("#bgColor").css("background-color");$("#bgColor").removeAttr("style");$("#bgColor").css("background",n);$("#bgColor").removeClass("fr-box")});$("#fr-save").on("click",function(){$(".tab-menu").removeClass("disabled-block");$("#bgColor").removeClass("outline");$("#bgColor").resizable("destroy");$("#bgColor").draggable("destroy");$("#bgColor").rotatable("destroy");$("#fr-edit").fadeIn();$("#fr-cancel").hide();$(".btn-action").show();$("#fr-edit").removeClass("disabled");$("#fr-save").addClass("disabled");$(".fr-option").addClass("disabled-frame")});var n=document.getElementById("opacityRange");noUiSlider.create(n,{start:[0,100],connect:!0,step:1,range:{min:0,max:100},format:wNumb({decimals:0})});n.noUiSlider.on("update",function(){var t=n.noUiSlider.get();opacityValue=t[1];$("#bgColor").css("opacity",opacityValue/100);$("#opacity-val").val(opacityValue)});$("#opacity-val").on("change",function(){opacityValue=$(this).val();var n=document.getElementById("opacityRange");n.noUiSlider.reset();n.noUiSlider.set([0,this.opacityValue]);$("#bgColor").css("opacity",opacityValue/100);$("#opacity-val").val(opacityValue)})};this.editLogo=function(){$("#popSave").on("click",function(){$("#logoUp").append('<img src="'+$("#urlLogo").val()+'">');$(".logo-list li").fadeIn();$("#uploadPopup").modal("close")});$("#logoUp").on("click",function(){$("#editLogo img").attr("src",$(this).find("img").attr("src"));$("#editLogo").fadeIn();common.setLogoHeightReponsive()});$("#logoCustomize").draggable({cursor:"move",containment:"#editLogo",stop:function(){$(this).css("left",parseFloat($(this).css("left"))/($("#editLogo").width()/100)+"%");$(this).css("top",parseFloat($(this).css("top"))/($("#editLogo").height()/100)+"%")}});var n=imageSize*.3125;$("#editLogo").resizable({grid:[1e4,1],maxHeight:n,stop:function(n,t){var i=t.element.parent();t.element.css({height:t.element.height()/i.height()*100+"%"})}});$(".remove-logo").on("click",function(){$("#editLogo").fadeOut();$("#editLogo").find("img").attr("src","")});$("#listLogo li a").on("click",function(){$("#logoDrop span").text($(this).text());$("#listLogo li a").removeClass("active");$(this).addClass("active");$(this).attr("logo-type")=="circle"?$("#editLogo").addClass("circle"):$("#editLogo").removeClass("circle")})};this.exportQR=function(){$("#downloadOptions a").on("click",function(){$("body").append('<div class="modal-backdrop fade in" id="loading"><div class="loadding-pannel"><div class="loader-spin"><div class="fade-circle"><\/div><\/div><\/div><\/div>');var n=$(this).attr("data-download");switch(n){case"SVG":common.exportToSVG("qrcode.svg");break;case"PNG":common.exportToPNG("qrcode.png");break;case"JPG":common.exportToJPG("qrcode.jpeg")}})};this.init=function(){this.loadQRByID(qrId);this.editBackground();this.editDataPartenr();this.editEye();this.editFrame();this.editLogo();this.exportQR()}}var qrId=window.location.href.split("?id=")[1],common=new CommonFunction,bgColor,dataColor,eye_l_in,eye_l_out,eye_r_in,eye_r_out,eye_b_in,eye_b_out,opacityValue=100,imageSize;$(document).ready(function(){var n=new customizeQR;n.init()});